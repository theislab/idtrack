{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "f0a953fc-cc27-4a89-b264-153f2f7cad0e",
   "metadata": {},
   "source": [
    "# Multiple Dataset Harmonization Tutorial"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "81cbe3eb-7756-491a-9eda-78164543c813",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "092be887-d9f2-446c-b89c-2fd1f8f75a88",
   "metadata": {},
   "outputs": [],
   "source": [
    "%load_ext autoreload\n",
    "%autoreload 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "44b3f875-10f3-4301-b9e0-b64f25b12dce",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sys\n",
    "\n",
    "sys.path.append(\"/home/icb/kemal.inecik/work/codes/idtrack\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "fbc5ad8e-5349-4e46-83c3-c9ab16db3052",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import pickle\n",
    "import subprocess\n",
    "import time\n",
    "\n",
    "import idtrack\n",
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0f5f65a1-9c9d-40ad-aba7-5cd52b01cc97",
   "metadata": {},
   "source": [
    "Initialize the graph and pathfinder"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "19a77f26-5852-4c04-a2a0-cab6bf3a9e75",
   "metadata": {},
   "outputs": [],
   "source": [
    "local_dir = \"/lustre/groups/ml01/workspace/kemal.inecik/idtrack_temp\"\n",
    "test_results_dir = os.path.join(local_dir, \"hlca_harmonization\")\n",
    "os.makedirs(test_results_dir, exist_ok=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "99722a75-43cb-4947-8cdd-a1bcebbe1b57",
   "metadata": {},
   "source": [
    "The datasets of HLCA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "dbed66bd-cb19-454c-8d98-a976a8f36b87",
   "metadata": {},
   "outputs": [],
   "source": [
    "base_path = \"/lustre/groups/ml01/projects/2023_HLCA_LSikkema/HLCA_reproducibility/data\"\n",
    "dset0_dir = os.path.join(base_path, \"HLCA_extended/extension_datasets/ready/full\")\n",
    "dset1_dir = os.path.join(base_path, \"HLCA_extended/extension_datasets/raw\")\n",
    "\n",
    "data_h5ad_dict = {\n",
    "    \"Meyer_2021\": f\"{dset0_dir}/meyer_2021.h5ad\",\n",
    "    \"MeyerNikolic_unpubl\": f\"{dset0_dir}/meyer_nikolic_unpubl.h5ad\",\n",
    "    \"Barbry_unpubl\": f\"{dset0_dir}/barbry.h5ad\",\n",
    "    \"Thienpont_2018\": f\"{dset1_dir}/Lambrechts/lambrechts.h5ad\",\n",
    "    \"Budinger_2020\": f\"{dset0_dir}/bharat.h5ad\",\n",
    "    \"Banovich_Kropski_2020\": f\"{dset0_dir}/haberman.h5ad\",\n",
    "    \"Sheppard_2020\": f\"{dset0_dir}/tsukui.h5ad\",\n",
    "    \"Lambrechts_2021\": f\"{dset0_dir}/wouters.h5ad\"\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "5e3c860c-2533-48a7-b216-66c05a768305",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2025-06-02 14:50:52 INFO:verify_organism: Ensembl Rest API query to get the organism names and associated releases.\n",
      "2025-06-02 14:50:55 INFO:graph_maker: The graph is being read: /lustre/groups/ml01/workspace/kemal.inecik/idtrack_temp/graph_homo_sapiens_min79_max114_narrow.pickle\n",
      "2025-06-02 14:51:46 INFO:the_graph: Cached properties being calculated: combined_edges\n",
      "2025-06-02 14:52:27 INFO:the_graph: Cached properties being calculated: combined_edges_assembly_specific_genes\n",
      "2025-06-02 14:52:31 INFO:the_graph: Cached properties being calculated: combined_edges_genes\n",
      "2025-06-02 14:53:07 INFO:the_graph: Cached properties being calculated: lower_chars_graph\n",
      "2025-06-02 14:53:08 INFO:the_graph: Cached properties being calculated: get_active_ranges_of_id\n",
      "2025-06-02 14:53:30 INFO:the_graph: Cached properties being calculated: available_external_databases\n",
      "2025-06-02 14:53:31 INFO:the_graph: Cached properties being calculated: available_genome_assemblies\n",
      "2025-06-02 14:53:32 INFO:the_graph: Cached properties being calculated: available_external_databases_assembly\n",
      "2025-06-02 14:53:33 INFO:the_graph: Cached properties being calculated: node_trios\n",
      "2025-06-02 14:53:53 INFO:the_graph: Cached properties being calculated: hyperconnective_nodes\n",
      "Meyer_2021: 100%|██████████████████████████████| 20922/20922 [04:40<00:00, 74.51it/s, ID:AC240274.1]\n",
      "2025-06-02 14:59:06 INFO:harmonize_features: Meyer_2021\n",
      "2025-06-02 14:59:06 INFO:api: \n",
      "changed_only_1_to_n: 0\n",
      "changed_only_1_to_1: 1185\n",
      "alternative_target_1_to_1: 340\n",
      "alternative_target_1_to_n: 2\n",
      "matching_1_to_0: 19\n",
      "matching_1_to_1: 20561\n",
      "matching_1_to_n: 0\n",
      "input_identifiers: 20922\n",
      "MeyerNikolic_unpubl: 100%|██████████████████| 33582/33582 [05:00<00:00, 111.74it/s, ID:hsa-mir-1253]\n",
      "2025-06-02 15:04:47 INFO:harmonize_features: MeyerNikolic_unpubl\n",
      "2025-06-02 15:04:47 INFO:api: \n",
      "changed_only_1_to_n: 6\n",
      "changed_only_1_to_1: 3423\n",
      "alternative_target_1_to_1: 7814\n",
      "alternative_target_1_to_n: 9\n",
      "matching_1_to_0: 164\n",
      "matching_1_to_1: 25589\n",
      "matching_1_to_n: 6\n",
      "input_identifiers: 33582\n",
      "Barbry_unpubl: 100%|█████████████████████████████████| 16859/16859 [04:00<00:00, 70.09it/s, ID:WHRN]\n",
      "2025-06-02 15:09:25 INFO:harmonize_features: Barbry_unpubl\n",
      "2025-06-02 15:09:25 INFO:api: \n",
      "changed_only_1_to_n: 1\n",
      "changed_only_1_to_1: 1213\n",
      "alternative_target_1_to_1: 1536\n",
      "alternative_target_1_to_n: 2\n",
      "matching_1_to_0: 30\n",
      "matching_1_to_1: 15290\n",
      "matching_1_to_n: 1\n",
      "input_identifiers: 16859\n",
      "Thienpont_2018: 100%|█████████████████████████| 27958/27958 [04:34<00:00, 101.83it/s, ID:AC240274.1]\n",
      "2025-06-02 15:14:30 INFO:harmonize_features: Thienpont_2018\n",
      "2025-06-02 15:14:30 INFO:api: \n",
      "changed_only_1_to_n: 3\n",
      "changed_only_1_to_1: 4133\n",
      "alternative_target_1_to_1: 4921\n",
      "alternative_target_1_to_n: 32\n",
      "matching_1_to_0: 222\n",
      "matching_1_to_1: 22780\n",
      "matching_1_to_n: 3\n",
      "input_identifiers: 27958\n",
      "Budinger_2020: 100%|████████████████████████████████| 26316/26316 [04:29<00:00, 97.61it/s, ID:ZZEF1]\n",
      "2025-06-02 15:19:38 INFO:harmonize_features: Budinger_2020\n",
      "2025-06-02 15:19:38 INFO:api: \n",
      "changed_only_1_to_n: 4\n",
      "changed_only_1_to_1: 2641\n",
      "alternative_target_1_to_1: 4431\n",
      "alternative_target_1_to_n: 5\n",
      "matching_1_to_0: 94\n",
      "matching_1_to_1: 21782\n",
      "matching_1_to_n: 4\n",
      "input_identifiers: 26316\n",
      "Banovich_Kropski_2020: 100%|█████████████████████| 33694/33694 [04:56<00:00, 113.59it/s, ID:FAM231B]\n",
      "2025-06-02 15:25:11 INFO:harmonize_features: Banovich_Kropski_2020\n",
      "2025-06-02 15:25:11 INFO:api: \n",
      "changed_only_1_to_n: 5\n",
      "changed_only_1_to_1: 5157\n",
      "alternative_target_1_to_1: 7569\n",
      "alternative_target_1_to_n: 46\n",
      "matching_1_to_0: 330\n",
      "matching_1_to_1: 25744\n",
      "matching_1_to_n: 5\n",
      "input_identifiers: 33694\n",
      "Sheppard_2020: 100%|███████████████████████████| 27147/27147 [04:35<00:00, 98.61it/s, ID:AC240274.1]\n",
      "2025-06-02 15:30:20 INFO:harmonize_features: Sheppard_2020\n",
      "2025-06-02 15:30:20 INFO:api: \n",
      "changed_only_1_to_n: 4\n",
      "changed_only_1_to_1: 3970\n",
      "alternative_target_1_to_1: 4620\n",
      "alternative_target_1_to_n: 30\n",
      "matching_1_to_0: 218\n",
      "matching_1_to_1: 22275\n",
      "matching_1_to_n: 4\n",
      "input_identifiers: 27147\n",
      "Lambrechts_2021: 100%|███████████████████████████| 33538/33538 [04:57<00:00, 112.78it/s, ID:FAM231C]\n",
      "2025-06-02 15:35:53 INFO:harmonize_features: Lambrechts_2021\n",
      "2025-06-02 15:35:53 INFO:api: \n",
      "changed_only_1_to_n: 6\n",
      "changed_only_1_to_1: 3405\n",
      "alternative_target_1_to_1: 7814\n",
      "alternative_target_1_to_n: 9\n",
      "matching_1_to_0: 138\n",
      "matching_1_to_1: 25571\n",
      "matching_1_to_n: 6\n",
      "input_identifiers: 33538\n"
     ]
    }
   ],
   "source": [
    "harmonizer = idtrack.HarmonizeFeatures(\n",
    "    project_name=\"hlca\",\n",
    "    data_h5ad_dict=data_h5ad_dict,\n",
    "    project_local_repository=test_results_dir,\n",
    "    idtrack_local_repository=local_dir,\n",
    "    target_ensembl_release=114,\n",
    "    final_database=\"HGNC Symbol\",\n",
    "    organism_name=\"homo_sapiens\",\n",
    "    graph_last_ensembl_release=114\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "2af5a1af-dea1-4f8f-af43-5ca1f1aab473",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|████████████████████████████████████| 8/8 [09:02<00:00, 67.75s/it, dataset=Lambrechts_2021, study_var=31595, union_var=33488, dbh=1943]\n"
     ]
    }
   ],
   "source": [
    "unified_adata = harmonizer.unify_multiple_anndatas(\n",
    "    obs_columns_to_keep=None  # forget all obs columns.\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "638403b4-fa9b-4b77-98c9-c634366307ff",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "AnnData object with n_obs × n_vars = 879961 × 33488\n",
       "    obs: 'handle_anndata'\n",
       "    var: 'converted_id_Meyer_2021', 'converted_id_MeyerNikolic_unpubl', 'converted_id_Barbry_unpubl', 'converted_id_Thienpont_2018', 'converted_id_Budinger_2020', 'converted_id_Banovich_Kropski_2020', 'converted_id_Sheppard_2020', 'converted_id_Lambrechts_2021', 'converted_id', 'intersection'"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "unified_adata"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "aff7b481-df72-434a-bef1-5d9b47f264fa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>handle_anndata</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Meyer_2021_AAACCTGGTGTGAATA-1-WTDAtest7887999-0</th>\n",
       "      <td>Meyer_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Meyer_2021_AAACGGGCAACCGCCA-1-WTDAtest7887999-0</th>\n",
       "      <td>Meyer_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Meyer_2021_AACCATGGTACAGCAG-1-WTDAtest7887999-0</th>\n",
       "      <td>Meyer_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Meyer_2021_AACGTTGGTGTCCTCT-1-WTDAtest7887999-0</th>\n",
       "      <td>Meyer_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Meyer_2021_AACTCCCTCCTAGTGA-1-WTDAtest7887999-0</th>\n",
       "      <td>Meyer_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lambrechts_2021_BAL029_GGGCATCTCTAACTCT-1</th>\n",
       "      <td>Lambrechts_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lambrechts_2021_BAL029_TATGCCCTCATGGTCA-1</th>\n",
       "      <td>Lambrechts_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lambrechts_2021_BAL029_TGCTGCTAGCGACGTA-1</th>\n",
       "      <td>Lambrechts_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lambrechts_2021_BAL029_TTAGGACTCAGCAACT-1</th>\n",
       "      <td>Lambrechts_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lambrechts_2021_BAL029_TTAGTTCTCAGAGCTT-1</th>\n",
       "      <td>Lambrechts_2021</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>879961 rows × 1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                  handle_anndata\n",
       "Meyer_2021_AAACCTGGTGTGAATA-1-WTDAtest7887999-0       Meyer_2021\n",
       "Meyer_2021_AAACGGGCAACCGCCA-1-WTDAtest7887999-0       Meyer_2021\n",
       "Meyer_2021_AACCATGGTACAGCAG-1-WTDAtest7887999-0       Meyer_2021\n",
       "Meyer_2021_AACGTTGGTGTCCTCT-1-WTDAtest7887999-0       Meyer_2021\n",
       "Meyer_2021_AACTCCCTCCTAGTGA-1-WTDAtest7887999-0       Meyer_2021\n",
       "...                                                          ...\n",
       "Lambrechts_2021_BAL029_GGGCATCTCTAACTCT-1        Lambrechts_2021\n",
       "Lambrechts_2021_BAL029_TATGCCCTCATGGTCA-1        Lambrechts_2021\n",
       "Lambrechts_2021_BAL029_TGCTGCTAGCGACGTA-1        Lambrechts_2021\n",
       "Lambrechts_2021_BAL029_TTAGGACTCAGCAACT-1        Lambrechts_2021\n",
       "Lambrechts_2021_BAL029_TTAGTTCTCAGAGCTT-1        Lambrechts_2021\n",
       "\n",
       "[879961 rows x 1 columns]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "unified_adata.obs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "983d630e-f2af-4b30-b2a8-dac1b4406451",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>converted_id_Meyer_2021</th>\n",
       "      <th>converted_id_MeyerNikolic_unpubl</th>\n",
       "      <th>converted_id_Barbry_unpubl</th>\n",
       "      <th>converted_id_Thienpont_2018</th>\n",
       "      <th>converted_id_Budinger_2020</th>\n",
       "      <th>converted_id_Banovich_Kropski_2020</th>\n",
       "      <th>converted_id_Sheppard_2020</th>\n",
       "      <th>converted_id_Lambrechts_2021</th>\n",
       "      <th>converted_id</th>\n",
       "      <th>intersection</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>AC016831.7</th>\n",
       "      <td>AC016831.7</td>\n",
       "      <td>AC016831.7</td>\n",
       "      <td>AC016831.7</td>\n",
       "      <td>AC016831.7</td>\n",
       "      <td>AC016831.7</td>\n",
       "      <td>AC016831.7</td>\n",
       "      <td>AC016831.7</td>\n",
       "      <td>AC016831.7</td>\n",
       "      <td>AC016831.7</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AC019117.1</th>\n",
       "      <td>AC019117.1</td>\n",
       "      <td>AC019117.1</td>\n",
       "      <td>AC019117.1</td>\n",
       "      <td>AC019117.1</td>\n",
       "      <td>AC019117.1</td>\n",
       "      <td>AC019117.1</td>\n",
       "      <td>AC019117.1</td>\n",
       "      <td>AC019117.1</td>\n",
       "      <td>AC019117.1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AC019117.2</th>\n",
       "      <td>AC019117.2</td>\n",
       "      <td>AC019117.2</td>\n",
       "      <td>AC019117.2</td>\n",
       "      <td>AC019117.2</td>\n",
       "      <td>AC019117.2</td>\n",
       "      <td>AC019117.2</td>\n",
       "      <td>AC019117.2</td>\n",
       "      <td>AC019117.2</td>\n",
       "      <td>AC019117.2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AC058791.1</th>\n",
       "      <td>AC058791.1</td>\n",
       "      <td>AC058791.1</td>\n",
       "      <td>AC058791.1</td>\n",
       "      <td>AC058791.1</td>\n",
       "      <td>AC058791.1</td>\n",
       "      <td>AC058791.1</td>\n",
       "      <td>AC058791.1</td>\n",
       "      <td>AC058791.1</td>\n",
       "      <td>AC058791.1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AC062029.1</th>\n",
       "      <td>AC062029.1</td>\n",
       "      <td>AC062029.1</td>\n",
       "      <td>AC062029.1</td>\n",
       "      <td>AC062029.1</td>\n",
       "      <td>AC062029.1</td>\n",
       "      <td>AC062029.1</td>\n",
       "      <td>AC062029.1</td>\n",
       "      <td>AC062029.1</td>\n",
       "      <td>AC062029.1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MTRNR2L3</th>\n",
       "      <td>MTRNR2L3</td>\n",
       "      <td>MTRNR2L3</td>\n",
       "      <td>MTRNR2L3</td>\n",
       "      <td>MTRNR2L3</td>\n",
       "      <td>MTRNR2L3</td>\n",
       "      <td>MTRNR2L3</td>\n",
       "      <td>MTRNR2L3</td>\n",
       "      <td>MTRNR2L3</td>\n",
       "      <td>MTRNR2L3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MTRNR2L4</th>\n",
       "      <td>MTRNR2L4</td>\n",
       "      <td>MTRNR2L4</td>\n",
       "      <td>MTRNR2L4</td>\n",
       "      <td>MTRNR2L4</td>\n",
       "      <td>MTRNR2L4</td>\n",
       "      <td>MTRNR2L4</td>\n",
       "      <td>MTRNR2L4</td>\n",
       "      <td>MTRNR2L4</td>\n",
       "      <td>MTRNR2L4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PRR34-AS1</th>\n",
       "      <td>PRR34-AS1</td>\n",
       "      <td>PRR34-AS1</td>\n",
       "      <td>PRR34-AS1</td>\n",
       "      <td>PRR34-AS1</td>\n",
       "      <td>PRR34-AS1</td>\n",
       "      <td>PRR34-AS1</td>\n",
       "      <td>PRR34-AS1</td>\n",
       "      <td>PRR34-AS1</td>\n",
       "      <td>PRR34-AS1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SMC5-AS1</th>\n",
       "      <td>SMC5-AS1</td>\n",
       "      <td>SMC5-AS1</td>\n",
       "      <td>SMC5-AS1</td>\n",
       "      <td>SMC5-AS1</td>\n",
       "      <td>SMC5-AS1</td>\n",
       "      <td>SMC5-AS1</td>\n",
       "      <td>SMC5-AS1</td>\n",
       "      <td>SMC5-AS1</td>\n",
       "      <td>SMC5-AS1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TIAF1</th>\n",
       "      <td>TIAF1</td>\n",
       "      <td>TIAF1</td>\n",
       "      <td>TIAF1</td>\n",
       "      <td>TIAF1</td>\n",
       "      <td>TIAF1</td>\n",
       "      <td>TIAF1</td>\n",
       "      <td>TIAF1</td>\n",
       "      <td>TIAF1</td>\n",
       "      <td>TIAF1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>33488 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           converted_id_Meyer_2021 converted_id_MeyerNikolic_unpubl  \\\n",
       "AC016831.7              AC016831.7                       AC016831.7   \n",
       "AC019117.1              AC019117.1                       AC019117.1   \n",
       "AC019117.2              AC019117.2                       AC019117.2   \n",
       "AC058791.1              AC058791.1                       AC058791.1   \n",
       "AC062029.1              AC062029.1                       AC062029.1   \n",
       "...                            ...                              ...   \n",
       "MTRNR2L3                  MTRNR2L3                         MTRNR2L3   \n",
       "MTRNR2L4                  MTRNR2L4                         MTRNR2L4   \n",
       "PRR34-AS1                PRR34-AS1                        PRR34-AS1   \n",
       "SMC5-AS1                  SMC5-AS1                         SMC5-AS1   \n",
       "TIAF1                        TIAF1                            TIAF1   \n",
       "\n",
       "           converted_id_Barbry_unpubl converted_id_Thienpont_2018  \\\n",
       "AC016831.7                 AC016831.7                  AC016831.7   \n",
       "AC019117.1                 AC019117.1                  AC019117.1   \n",
       "AC019117.2                 AC019117.2                  AC019117.2   \n",
       "AC058791.1                 AC058791.1                  AC058791.1   \n",
       "AC062029.1                 AC062029.1                  AC062029.1   \n",
       "...                               ...                         ...   \n",
       "MTRNR2L3                     MTRNR2L3                    MTRNR2L3   \n",
       "MTRNR2L4                     MTRNR2L4                    MTRNR2L4   \n",
       "PRR34-AS1                   PRR34-AS1                   PRR34-AS1   \n",
       "SMC5-AS1                     SMC5-AS1                    SMC5-AS1   \n",
       "TIAF1                           TIAF1                       TIAF1   \n",
       "\n",
       "           converted_id_Budinger_2020 converted_id_Banovich_Kropski_2020  \\\n",
       "AC016831.7                 AC016831.7                         AC016831.7   \n",
       "AC019117.1                 AC019117.1                         AC019117.1   \n",
       "AC019117.2                 AC019117.2                         AC019117.2   \n",
       "AC058791.1                 AC058791.1                         AC058791.1   \n",
       "AC062029.1                 AC062029.1                         AC062029.1   \n",
       "...                               ...                                ...   \n",
       "MTRNR2L3                     MTRNR2L3                           MTRNR2L3   \n",
       "MTRNR2L4                     MTRNR2L4                           MTRNR2L4   \n",
       "PRR34-AS1                   PRR34-AS1                          PRR34-AS1   \n",
       "SMC5-AS1                     SMC5-AS1                           SMC5-AS1   \n",
       "TIAF1                           TIAF1                              TIAF1   \n",
       "\n",
       "           converted_id_Sheppard_2020 converted_id_Lambrechts_2021  \\\n",
       "AC016831.7                 AC016831.7                   AC016831.7   \n",
       "AC019117.1                 AC019117.1                   AC019117.1   \n",
       "AC019117.2                 AC019117.2                   AC019117.2   \n",
       "AC058791.1                 AC058791.1                   AC058791.1   \n",
       "AC062029.1                 AC062029.1                   AC062029.1   \n",
       "...                               ...                          ...   \n",
       "MTRNR2L3                     MTRNR2L3                     MTRNR2L3   \n",
       "MTRNR2L4                     MTRNR2L4                     MTRNR2L4   \n",
       "PRR34-AS1                   PRR34-AS1                    PRR34-AS1   \n",
       "SMC5-AS1                     SMC5-AS1                     SMC5-AS1   \n",
       "TIAF1                           TIAF1                        TIAF1   \n",
       "\n",
       "           converted_id  intersection  \n",
       "AC016831.7   AC016831.7             1  \n",
       "AC019117.1   AC019117.1             1  \n",
       "AC019117.2   AC019117.2             1  \n",
       "AC058791.1   AC058791.1             1  \n",
       "AC062029.1   AC062029.1             1  \n",
       "...                 ...           ...  \n",
       "MTRNR2L3       MTRNR2L3             1  \n",
       "MTRNR2L4       MTRNR2L4             1  \n",
       "PRR34-AS1     PRR34-AS1             1  \n",
       "SMC5-AS1       SMC5-AS1             1  \n",
       "TIAF1             TIAF1             1  \n",
       "\n",
       "[33488 rows x 10 columns]"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "unified_adata.var"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "1fe6a7e8-5d2d-4231-a085-5f0f6fcb0a8c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "13799"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.sum(unified_adata.var[\"intersection\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "88b78b4b-27d5-4540-b197-debf471b75d8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00d7ebfd-f6dd-4077-b42e-c4541afe164a",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
