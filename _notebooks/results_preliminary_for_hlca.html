

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Use Case: HLCA Datasets &mdash; idtrack 0.0.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/custom_settings.css?v=15bcc2cf" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8c5712d9"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Calculations with Random Data" href="random_data.html" />
    <link rel="prev" title="Initialization and Tests" href="initialization_test.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            idtrack
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../usage.html">Usage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="prepare_new_external_yaml.html">External Database Description Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="initialization_graph.html">Initialize Graph Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="initialization_test.html">Initialization and Tests</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Use Case: HLCA Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="random_data.html">Calculations with Random Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="comparison.html">Comparison with Available Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Contributor Covenant Code of Conduct</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">idtrack</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../usage.html">Usage</a></li>
      <li class="breadcrumb-item active">Use Case: HLCA Datasets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_notebooks/results_preliminary_for_hlca.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Use-Case:-HLCA-Datasets">
<h1>Use Case: HLCA Datasets<a class="headerlink" href="#Use-Case:-HLCA-Datasets" title="Link to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../..&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">idtrack</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<p>Initialize the graph and pathfinder</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">local_dir</span> <span class="o">=</span> <span class="s2">&quot;/lustre/groups/ml01/workspace/kemal.inecik/idtrack_temp&quot;</span>
<span class="n">idt</span> <span class="o">=</span> <span class="n">idtrack</span><span class="o">.</span><span class="n">API</span><span class="p">(</span><span class="n">local_repository</span><span class="o">=</span><span class="n">local_dir</span><span class="p">)</span>
<span class="n">idt</span><span class="o">.</span><span class="n">configure_logger</span><span class="p">()</span>
<span class="n">idt</span><span class="o">.</span><span class="n">initialize_graph</span><span class="p">(</span><span class="n">organism_name</span><span class="o">=</span><span class="s1">&#39;homo_sapiens&#39;</span><span class="p">,</span> <span class="n">ensembl_release</span><span class="o">=</span><span class="mi">107</span><span class="p">,</span> <span class="n">return_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-29 23:26:20 INFO:graph_maker: The graph is being read.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idt</span><span class="o">.</span><span class="n">calculate_graph_caches</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-29 23:27:23 INFO:the_graph: Cached properties being calculated: combined_edges
2023-01-29 23:28:07 INFO:the_graph: Cached properties being calculated: combined_edges_assembly_specific_genes
2023-01-29 23:28:11 INFO:the_graph: Cached properties being calculated: combined_edges_genes
2023-01-29 23:28:24 INFO:the_graph: Cached properties being calculated: lower_chars_graph
2023-01-29 23:28:25 INFO:the_graph: Cached properties being calculated: get_active_ranges_of_id
2023-01-29 23:28:48 INFO:the_graph: Cached properties being calculated: available_external_databases
2023-01-29 23:28:50 INFO:the_graph: Cached properties being calculated: external_database_connection_form
2023-01-29 23:29:38 INFO:the_graph: Cached properties being calculated: available_genome_assemblies
2023-01-29 23:29:39 INFO:the_graph: Cached properties being calculated: available_external_databases_assembly
2023-01-29 23:29:41 INFO:the_graph: Cached properties being calculated: node_trios
</pre></div></div>
</div>
<p>The datasets of HLCA</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_path</span> <span class="o">=</span> <span class="s2">&quot;/lustre/groups/ml01/workspace/hlca_lisa.sikkema_malte.luecken/HLCA_reproducibility/data&quot;</span>
<span class="n">dset0_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="s2">&quot;HLCA_extended/extension_datasets/ready/full&quot;</span><span class="p">)</span>
<span class="n">dset1_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="s2">&quot;HLCA_extended/extension_datasets/raw&quot;</span><span class="p">)</span>

<span class="n">adata_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Kaminski_2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/adams.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Meyer_2021&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/meyer_2021.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;MeyerNikolic_unpubl&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/meyer_nikolic_unpubl.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Barbry_unpubl&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/barbry.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Regev_2021&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/delorey_cryo.h5ad&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/delorey_fresh.h5ad&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/delorey_nuclei.h5ad&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Thienpont_2018&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset1_dir</span><span class="si">}</span><span class="s2">/Lambrechts/lambrechts.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Budinger_2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/bharat.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Banovich_Kropski_2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/haberman.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Sheppard_2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/tsukui.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Wunderink_2021&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/grant_cryo.h5ad&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/grant_fresh.h5ad&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Lambrechts_2021&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/wouters.h5ad&quot;</span> <span class="c1">#, f&quot;{dset0_dir}/wouters_labs.h5ad&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Zhang_2021&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset1_dir</span><span class="si">}</span><span class="s2">/Liao/covid_for_publish.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Duong_lungMAP_unpubl&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/duong.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Janssen_2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/mould.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Sun_2020&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/wang_sub_batch1.h5ad&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/wang_sub_batch2.h5ad&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/wang_sub_batch3.h5ad&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/wang_sub_batch4.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Gomperts_2021&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/carraro_ucla.h5ad&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/carraro_cff.h5ad&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/carraro_csmc.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Eils_2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/lukassen.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Schiller_2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/mayr.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Misharin_Budinger_2018&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/reyfman_disease.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Shalek_2018&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/ordovasmontanes.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Schiller_2021&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/schiller_discovair.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Peer_Massague_2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/laughney.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Lafyatis_2019&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/valenzi.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Tata_unpubl&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/tata_unpubl.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Xu_2020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/guo.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Sims_2019&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/szabo.h5ad&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Schultze_unpubl&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dset0_dir</span><span class="si">}</span><span class="s2">/schultze_unpubl.h5ad&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Run the ID conversion with HGNC Symbol (a.k.a gene name)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">final_database</span><span class="o">=</span><span class="s2">&quot;HGNC Symbol&quot;</span>

<span class="k">for</span> <span class="n">dataset_name</span> <span class="ow">in</span> <span class="n">adata_dict</span><span class="p">:</span>

    <span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">adata_dict</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">gene_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="n">matching</span> <span class="o">=</span> <span class="n">idt</span><span class="o">.</span><span class="n">convert_identifier_multiple</span><span class="p">(</span><span class="n">gene_list</span><span class="p">,</span> <span class="n">final_database</span><span class="o">=</span><span class="n">final_database</span><span class="p">,</span> <span class="n">pbar_prefix</span><span class="o">=</span><span class="n">dataset_name</span><span class="p">)</span>
    <span class="n">binned_conversions</span> <span class="o">=</span> <span class="n">idt</span><span class="o">.</span><span class="n">classify_multiple_conversion</span><span class="p">(</span><span class="n">matching</span><span class="p">)</span>

    <span class="n">idt</span><span class="o">.</span><span class="n">print_binned_conversion</span><span class="p">(</span><span class="n">binned_conversions</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Source release: </span><span class="si">{</span><span class="n">idt</span><span class="o">.</span><span class="n">infer_identifier_source</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">result</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">binned_conversions</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Kaminski_2020: 100%|██████████| 45947/45947 [05:05&lt;00:00, 150.37it/s, ID:ENSG00000280139]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 59
changed_only_1_to_1: 4002
alternative_target_1_to_1: 12331
alternative_target_1_to_n: 13
matching_1_to_0: 98
matching_1_to_1: 33446
matching_1_to_n: 59
input_identifiers: 45947
Source release: (38, 94)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Meyer_2021: 100%|███████████████████| 20922/20922 [04:38&lt;00:00, 75.08it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 3
changed_only_1_to_1: 997
alternative_target_1_to_1: 368
alternative_target_1_to_n: 2
matching_1_to_0: 17
matching_1_to_1: 20532
matching_1_to_n: 3
input_identifiers: 20922
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
MeyerNikolic_unpubl: 100%|███████| 33582/33582 [04:52&lt;00:00, 114.64it/s, ID:hsa-mir-1253]
2023-01-29 23:45:46 WARNING:api: Number of unfound IDs: 27.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 15
changed_only_1_to_1: 2711
alternative_target_1_to_1: 8342
alternative_target_1_to_n: 10
matching_1_to_0: 106
matching_1_to_1: 25109
matching_1_to_n: 15
input_identifiers: 33582
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Barbry_unpubl: 100%|██████████████████████| 16859/16859 [04:10&lt;00:00, 67.29it/s, ID:WHRN]
2023-01-29 23:50:10 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 1
changed_only_1_to_1: 972
alternative_target_1_to_1: 1679
alternative_target_1_to_n: 4
matching_1_to_0: 20
matching_1_to_1: 15155
matching_1_to_n: 1
input_identifiers: 16859
Source release: (38, 98)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Regev_2021: 100%|████████████████████████| 30983/30983 [05:14&lt;00:00, 98.64it/s, ID:ZZEF1]
2023-01-29 23:55:25 WARNING:api: Number of unfound IDs: 48.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 8
changed_only_1_to_1: 2520
alternative_target_1_to_1: 7387
alternative_target_1_to_n: 9
matching_1_to_0: 113
matching_1_to_1: 23466
matching_1_to_n: 8
input_identifiers: 30983
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Thienpont_2018: 100%|███████████████| 27958/27958 [04:44&lt;00:00, 98.29it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 8
changed_only_1_to_1: 3598
alternative_target_1_to_1: 5342
alternative_target_1_to_n: 43
matching_1_to_0: 171
matching_1_to_1: 22394
matching_1_to_n: 8
input_identifiers: 27958
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Budinger_2020: 100%|█████████████████████| 26316/26316 [04:39&lt;00:00, 94.27it/s, ID:ZZEF1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 6
changed_only_1_to_1: 2122
alternative_target_1_to_1: 4807
alternative_target_1_to_n: 6
matching_1_to_0: 56
matching_1_to_1: 21441
matching_1_to_n: 6
input_identifiers: 26316
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Banovich_Kropski_2020: 100%|██████████| 33694/33694 [04:51&lt;00:00, 115.44it/s, ID:FAM231B]
2023-01-30 00:09:59 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 15
changed_only_1_to_1: 4470
alternative_target_1_to_1: 8131
alternative_target_1_to_n: 57
matching_1_to_0: 262
matching_1_to_1: 25229
matching_1_to_n: 15
input_identifiers: 33694
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sheppard_2020: 100%|████████████████| 27147/27147 [04:42&lt;00:00, 96.21it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 6
changed_only_1_to_1: 3464
alternative_target_1_to_1: 5020
alternative_target_1_to_n: 40
matching_1_to_0: 166
matching_1_to_1: 21915
matching_1_to_n: 6
input_identifiers: 27147
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Wunderink_2021: 100%|████████████████████| 21819/21819 [05:00&lt;00:00, 72.65it/s, ID:ZZEF1]
2023-01-30 00:19:55 WARNING:api: Number of unfound IDs: 12.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 2
changed_only_1_to_1: 1712
alternative_target_1_to_1: 2907
alternative_target_1_to_n: 1
matching_1_to_0: 53
matching_1_to_1: 18856
matching_1_to_n: 2
input_identifiers: 21819
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Lambrechts_2021: 100%|████████████████| 33538/33538 [04:50&lt;00:00, 115.40it/s, ID:FAM231C]
2023-01-30 00:24:48 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 15
changed_only_1_to_1: 2693
alternative_target_1_to_1: 8342
alternative_target_1_to_n: 10
matching_1_to_0: 80
matching_1_to_1: 25091
matching_1_to_n: 15
input_identifiers: 33538
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Zhang_2021: 100%|█████████████████████████| 18474/18474 [04:31&lt;00:00, 68.06it/s, ID:DSG1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 1
changed_only_1_to_1: 806
alternative_target_1_to_1: 99
alternative_target_1_to_n: 0
matching_1_to_0: 10
matching_1_to_1: 18364
matching_1_to_n: 1
input_identifiers: 18474
Source release: (38, 87)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Duong_lungMAP_unpubl: 100%|██████████████| 27678/27678 [04:37&lt;00:00, 99.63it/s, ID:ZZEF1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 6
changed_only_1_to_1: 2293
alternative_target_1_to_1: 5994
alternative_target_1_to_n: 10
matching_1_to_0: 51
matching_1_to_1: 21617
matching_1_to_n: 6
input_identifiers: 27678
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Janssen_2020: 100%|███████████████████| 33538/33538 [04:51&lt;00:00, 115.16it/s, ID:FAM231C]
2023-01-30 00:39:11 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 15
changed_only_1_to_1: 2693
alternative_target_1_to_1: 8342
alternative_target_1_to_n: 10
matching_1_to_0: 80
matching_1_to_1: 25091
matching_1_to_n: 15
input_identifiers: 33538
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sun_2020: 100%|█████████████████████| 26578/26578 [05:10&lt;00:00, 85.62it/s, ID:AP006748.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 6
changed_only_1_to_1: 2192
alternative_target_1_to_1: 5417
alternative_target_1_to_n: 8
matching_1_to_0: 50
matching_1_to_1: 21097
matching_1_to_n: 6
input_identifiers: 26578
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Gomperts_2021: 100%|███████████████████| 31229/31229 [04:57&lt;00:00, 104.83it/s, ID:WFDC11]
2023-01-30 00:49:23 WARNING:api: Number of unfound IDs: 187.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 14
changed_only_1_to_1: 4744
alternative_target_1_to_1: 5910
alternative_target_1_to_n: 28
matching_1_to_0: 348
matching_1_to_1: 24929
matching_1_to_n: 14
input_identifiers: 31229
Source release: (38, 89)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Eils_2020: 100%|███████████████████| 32738/32738 [04:55&lt;00:00, 110.71it/s, ID:AC002321.1]
2023-01-30 00:54:24 WARNING:api: Number of unfound IDs: 7.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 17
changed_only_1_to_1: 5448
alternative_target_1_to_1: 7519
alternative_target_1_to_n: 44
matching_1_to_0: 612
matching_1_to_1: 24546
matching_1_to_n: 17
input_identifiers: 32738
Source release: (37, 85)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Schiller_2020: 100%|█████████████| 32104/32104 [04:49&lt;00:00, 110.80it/s, ID:RP11-205K6.1]
2023-01-30 00:59:15 WARNING:api: Number of unfound IDs: 40.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 8
changed_only_1_to_1: 4469
alternative_target_1_to_1: 6431
alternative_target_1_to_n: 26
matching_1_to_0: 533
matching_1_to_1: 25106
matching_1_to_n: 8
input_identifiers: 32104
Source release: (38, 89)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Misharin_Budinger_2018: 100%|███████| 27181/27181 [04:45&lt;00:00, 95.28it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 7
changed_only_1_to_1: 3464
alternative_target_1_to_1: 5009
alternative_target_1_to_n: 43
matching_1_to_0: 177
matching_1_to_1: 21945
matching_1_to_n: 7
input_identifiers: 27181
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Shalek_2018: 100%|██████████████████████| 25328/25328 [04:40&lt;00:00, 90.33it/s, ID:TTTY10]
2023-01-30 01:08:47 WARNING:api: Number of unfound IDs: 22.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 7
changed_only_1_to_1: 3647
alternative_target_1_to_1: 3642
alternative_target_1_to_n: 33
matching_1_to_0: 492
matching_1_to_1: 21154
matching_1_to_n: 7
input_identifiers: 25328
Source release: (37, 85)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Schiller_2021: 100%|████████████████| 17533/17533 [04:59&lt;00:00, 58.55it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 0
changed_only_1_to_1: 497
alternative_target_1_to_1: 193
alternative_target_1_to_n: 0
matching_1_to_0: 10
matching_1_to_1: 17330
matching_1_to_n: 0
input_identifiers: 17533
Source release: (38, 99)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Peer_Massague_2020: 100%|█████████████████| 19222/19222 [04:31&lt;00:00, 70.76it/s, ID:ZZZ3]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 4
changed_only_1_to_1: 1545
alternative_target_1_to_1: 1247
alternative_target_1_to_n: 11
matching_1_to_0: 63
matching_1_to_1: 17897
matching_1_to_n: 4
input_identifiers: 19222
Source release: (38, 86)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Lafyatis_2019: 100%|████████████████| 22164/22164 [04:42&lt;00:00, 78.39it/s, ID:AC213203.1]
2023-01-30 01:23:09 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 6
changed_only_1_to_1: 1032
alternative_target_1_to_1: 442
alternative_target_1_to_n: 2
matching_1_to_0: 21
matching_1_to_1: 21693
matching_1_to_n: 6
input_identifiers: 22164
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Tata_unpubl: 100%|█████████████████| 31915/31915 [04:45&lt;00:00, 111.79it/s, ID:AC213203.1]
2023-01-30 01:27:57 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 11
changed_only_1_to_1: 1954
alternative_target_1_to_1: 7632
alternative_target_1_to_n: 6
matching_1_to_0: 36
matching_1_to_1: 24230
matching_1_to_n: 11
input_identifiers: 31915
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Xu_2020: 100%|█████████████████████| 32738/32738 [04:59&lt;00:00, 109.45it/s, ID:AC002321.1]
2023-01-30 01:32:59 WARNING:api: Number of unfound IDs: 7.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 17
changed_only_1_to_1: 5448
alternative_target_1_to_1: 7519
alternative_target_1_to_n: 44
matching_1_to_0: 612
matching_1_to_1: 24546
matching_1_to_n: 17
input_identifiers: 32738
Source release: (37, 85)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sims_2019: 100%|████████████████| 60725/60725 [08:50&lt;00:00, 114.41it/s, ID:CTD-2062F14.3]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 985
changed_only_1_to_1: 8062
alternative_target_1_to_1: 16431
alternative_target_1_to_n: 265
matching_1_to_0: 1461
matching_1_to_1: 41583
matching_1_to_n: 985
input_identifiers: 60725
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-30 01:41:52 WARNING:api: Number of unfound IDs: 10.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Source release: (38, 83)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Schultze_unpubl: 100%|██████████████| 24532/24532 [04:33&lt;00:00, 89.73it/s, ID:AP001269.4]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 5
changed_only_1_to_1: 2070
alternative_target_1_to_1: 3820
alternative_target_1_to_n: 6
matching_1_to_0: 46
matching_1_to_1: 20655
matching_1_to_n: 5
input_identifiers: 24532
Source release: (38, 91)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_suffix</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">-%H%M%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">())</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">local_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;results_for_hlca_datasets_</span><span class="si">{</span><span class="n">final_database</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">time_suffix</span><span class="si">}</span><span class="s2">.pk&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">handle</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saved: /lustre/groups/ml01/workspace/kemal.inecik/idtrack_temp/results_for_hlca_datasets_HGNC Symbol_20230130-004722.pk
</pre></div></div>
</div>
<p>Run the ID conversion with Ensembl gene ID</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">final_database</span><span class="o">=</span><span class="s2">&quot;ensembl_gene&quot;</span>

<span class="k">for</span> <span class="n">dataset_name</span> <span class="ow">in</span> <span class="n">adata_dict</span><span class="p">:</span>

    <span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">adata_dict</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">gene_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="n">matching</span> <span class="o">=</span> <span class="n">idt</span><span class="o">.</span><span class="n">convert_identifier_multiple</span><span class="p">(</span><span class="n">gene_list</span><span class="p">,</span> <span class="n">final_database</span><span class="o">=</span><span class="n">final_database</span><span class="p">,</span> <span class="n">pbar_prefix</span><span class="o">=</span><span class="n">dataset_name</span><span class="p">)</span>
    <span class="n">binned_conversions</span> <span class="o">=</span> <span class="n">idt</span><span class="o">.</span><span class="n">classify_multiple_conversion</span><span class="p">(</span><span class="n">matching</span><span class="p">)</span>

    <span class="n">idt</span><span class="o">.</span><span class="n">print_binned_conversion</span><span class="p">(</span><span class="n">binned_conversions</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Source release: </span><span class="si">{</span><span class="n">idt</span><span class="o">.</span><span class="n">infer_identifier_source</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">result</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">binned_conversions</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Kaminski_2020: 100%|██████████| 45947/45947 [03:58&lt;00:00, 193.04it/s, ID:ENSG00000280139]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 496
changed_only_1_to_1: 45353
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 98
matching_1_to_1: 45353
matching_1_to_n: 496
input_identifiers: 45947
Source release: (38, 94)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Meyer_2021: 100%|███████████████████| 20922/20922 [03:42&lt;00:00, 94.23it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 213
changed_only_1_to_1: 20692
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 17
matching_1_to_1: 20692
matching_1_to_n: 213
input_identifiers: 20922
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
MeyerNikolic_unpubl: 100%|███████| 33582/33582 [03:20&lt;00:00, 167.62it/s, ID:hsa-mir-1253]
2023-01-30 01:59:06 WARNING:api: Number of unfound IDs: 27.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 290
changed_only_1_to_1: 33186
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 106
matching_1_to_1: 33186
matching_1_to_n: 290
input_identifiers: 33582
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Barbry_unpubl: 100%|██████████████████████| 16859/16859 [03:21&lt;00:00, 83.67it/s, ID:WHRN]
2023-01-30 02:02:42 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 101
changed_only_1_to_1: 16738
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 20
matching_1_to_1: 16738
matching_1_to_n: 101
input_identifiers: 16859
Source release: (38, 98)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Regev_2021: 100%|███████████████████████| 30983/30983 [03:48&lt;00:00, 135.73it/s, ID:ZZEF1]
2023-01-30 02:06:31 WARNING:api: Number of unfound IDs: 48.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 222
changed_only_1_to_1: 30648
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 113
matching_1_to_1: 30648
matching_1_to_n: 222
input_identifiers: 30983
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Thienpont_2018: 100%|██████████████| 27958/27958 [03:45&lt;00:00, 123.97it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 246
changed_only_1_to_1: 27541
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 171
matching_1_to_1: 27541
matching_1_to_n: 246
input_identifiers: 27958
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Budinger_2020: 100%|████████████████████| 26316/26316 [03:12&lt;00:00, 136.63it/s, ID:ZZEF1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 194
changed_only_1_to_1: 26066
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 56
matching_1_to_1: 26066
matching_1_to_n: 194
input_identifiers: 26316
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Banovich_Kropski_2020: 100%|██████████| 33694/33694 [03:51&lt;00:00, 145.69it/s, ID:FAM231B]
2023-01-30 02:17:40 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 336
changed_only_1_to_1: 33096
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 262
matching_1_to_1: 33096
matching_1_to_n: 336
input_identifiers: 33694
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sheppard_2020: 100%|███████████████| 27147/27147 [03:43&lt;00:00, 121.66it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 239
changed_only_1_to_1: 26742
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 166
matching_1_to_1: 26742
matching_1_to_n: 239
input_identifiers: 27147
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Wunderink_2021: 100%|███████████████████| 21819/21819 [03:35&lt;00:00, 101.13it/s, ID:ZZEF1]
2023-01-30 02:25:11 WARNING:api: Number of unfound IDs: 12.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 169
changed_only_1_to_1: 21597
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 53
matching_1_to_1: 21597
matching_1_to_n: 169
input_identifiers: 21819
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Lambrechts_2021: 100%|████████████████| 33538/33538 [03:53&lt;00:00, 143.91it/s, ID:FAM231C]
2023-01-30 02:29:07 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 290
changed_only_1_to_1: 33168
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 80
matching_1_to_1: 33168
matching_1_to_n: 290
input_identifiers: 33538
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Zhang_2021: 100%|█████████████████████████| 18474/18474 [03:05&lt;00:00, 99.36it/s, ID:DSG1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 159
changed_only_1_to_1: 18305
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 10
matching_1_to_1: 18305
matching_1_to_n: 159
input_identifiers: 18474
Source release: (38, 87)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Duong_lungMAP_unpubl: 100%|█████████████| 27678/27678 [03:40&lt;00:00, 125.62it/s, ID:ZZEF1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 180
changed_only_1_to_1: 27447
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 51
matching_1_to_1: 27447
matching_1_to_n: 180
input_identifiers: 27678
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Janssen_2020: 100%|███████████████████| 33538/33538 [03:52&lt;00:00, 143.96it/s, ID:FAM231C]
2023-01-30 02:40:09 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 290
changed_only_1_to_1: 33168
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 80
matching_1_to_1: 33168
matching_1_to_n: 290
input_identifiers: 33538
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sun_2020: 100%|████████████████████| 26578/26578 [03:42&lt;00:00, 119.21it/s, ID:AP006748.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 161
changed_only_1_to_1: 26367
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 50
matching_1_to_1: 26367
matching_1_to_n: 161
input_identifiers: 26578
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Gomperts_2021: 100%|███████████████████| 31229/31229 [03:23&lt;00:00, 153.75it/s, ID:WFDC11]
2023-01-30 02:47:20 WARNING:api: Number of unfound IDs: 187.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 274
changed_only_1_to_1: 30607
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 348
matching_1_to_1: 30607
matching_1_to_n: 274
input_identifiers: 31229
Source release: (38, 89)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Eils_2020: 100%|███████████████████| 32738/32738 [03:59&lt;00:00, 136.92it/s, ID:AC002321.1]
2023-01-30 02:51:24 WARNING:api: Number of unfound IDs: 7.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 284
changed_only_1_to_1: 31842
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 612
matching_1_to_1: 31842
matching_1_to_n: 284
input_identifiers: 32738
Source release: (37, 85)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Schiller_2020: 100%|█████████████| 32104/32104 [03:48&lt;00:00, 140.54it/s, ID:RP11-205K6.1]
2023-01-30 02:55:14 WARNING:api: Number of unfound IDs: 40.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 263
changed_only_1_to_1: 31308
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 533
matching_1_to_1: 31308
matching_1_to_n: 263
input_identifiers: 32104
Source release: (38, 89)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Misharin_Budinger_2018: 100%|██████| 27181/27181 [03:44&lt;00:00, 120.93it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 251
changed_only_1_to_1: 26753
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 177
matching_1_to_1: 26753
matching_1_to_n: 251
input_identifiers: 27181
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Shalek_2018: 100%|█████████████████████| 25328/25328 [03:10&lt;00:00, 133.17it/s, ID:TTTY10]
2023-01-30 03:02:15 WARNING:api: Number of unfound IDs: 22.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 198
changed_only_1_to_1: 24638
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 492
matching_1_to_1: 24638
matching_1_to_n: 198
input_identifiers: 25328
Source release: (37, 85)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Schiller_2021: 100%|████████████████| 17533/17533 [03:34&lt;00:00, 81.76it/s, ID:AC240274.1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 139
changed_only_1_to_1: 17384
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 10
matching_1_to_1: 17384
matching_1_to_n: 139
input_identifiers: 17533
Source release: (38, 99)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Peer_Massague_2020: 100%|█████████████████| 19222/19222 [03:40&lt;00:00, 87.07it/s, ID:ZZZ3]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 155
changed_only_1_to_1: 19004
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 63
matching_1_to_1: 19004
matching_1_to_n: 155
input_identifiers: 19222
Source release: (38, 86)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Lafyatis_2019: 100%|███████████████| 22164/22164 [03:13&lt;00:00, 114.67it/s, ID:AC213203.1]
2023-01-30 03:12:53 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 258
changed_only_1_to_1: 21885
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 21
matching_1_to_1: 21885
matching_1_to_n: 258
input_identifiers: 22164
Source release: (38, 84)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Tata_unpubl: 100%|█████████████████| 31915/31915 [03:47&lt;00:00, 140.47it/s, ID:AC213203.1]
2023-01-30 03:16:43 WARNING:api: Number of unfound IDs: 1.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 280
changed_only_1_to_1: 31599
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 36
matching_1_to_1: 31599
matching_1_to_n: 280
input_identifiers: 31915
Source release: (38, 93)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Xu_2020: 100%|█████████████████████| 32738/32738 [03:58&lt;00:00, 137.10it/s, ID:AC002321.1]
2023-01-30 03:20:44 WARNING:api: Number of unfound IDs: 7.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 284
changed_only_1_to_1: 31842
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 612
matching_1_to_1: 31842
matching_1_to_n: 284
input_identifiers: 32738
Source release: (37, 85)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sims_2019: 100%|████████████████| 60725/60725 [06:26&lt;00:00, 157.24it/s, ID:CTD-2062F14.3]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 1830
changed_only_1_to_1: 57434
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 1461
matching_1_to_1: 57434
matching_1_to_n: 1830
input_identifiers: 60725
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-01-30 03:27:12 WARNING:api: Number of unfound IDs: 10.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Source release: (38, 83)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Schultze_unpubl: 100%|█████████████| 24532/24532 [03:36&lt;00:00, 113.41it/s, ID:AP001269.4]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
changed_only_1_to_n: 196
changed_only_1_to_1: 24290
alternative_target_1_to_1: 0
alternative_target_1_to_n: 0
matching_1_to_0: 46
matching_1_to_1: 24290
matching_1_to_n: 196
input_identifiers: 24532
Source release: (38, 91)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_suffix</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">-%H%M%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">())</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">local_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;results_for_hlca_datasets_</span><span class="si">{</span><span class="n">final_database</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">time_suffix</span><span class="si">}</span><span class="s2">.pk&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">handle</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saved: /lustre/groups/ml01/workspace/kemal.inecik/idtrack_temp/results_for_hlca_datasets_ensembl_gene_20230130-023149.pk
</pre></div></div>
</div>
<p>Print the processor</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="nb">print</span><span class="p">((</span><span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s2">&quot;lscpu&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Architecture:          x86_64
CPU op-mode(s):        32-bit, 64-bit
Byte Order:            Little Endian
CPU(s):                112
On-line CPU(s) list:   0-111
Thread(s) per core:    2
Core(s) per socket:    28
Socket(s):             2
NUMA node(s):          2
Vendor ID:             GenuineIntel
CPU family:            6
Model:                 85
Model name:            Intel(R) Xeon(R) Platinum 8280L CPU @ 2.70GHz
Stepping:              7
CPU MHz:               3634.881
CPU max MHz:           4000.0000
CPU min MHz:           1000.0000
BogoMIPS:              5400.00
Virtualization:        VT-x
L1d cache:             32K
L1i cache:             32K
L2 cache:              1024K
L3 cache:              39424K
NUMA node0 CPU(s):     0-27,56-83
NUMA node1 CPU(s):     28-55,84-111
Flags:                 fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch epb cat_l3 cdp_l3 invpcid_single intel_ppin intel_pt ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts pku ospke avx512_vnni md_clear spec_ctrl intel_stibp flush_l1d arch_capabilities
</pre></div></div>
</div>
<p>Plot/Table</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../..&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">local_dir</span> <span class="o">=</span> <span class="s2">&quot;/lustre/groups/ml01/workspace/kemal.inecik/idtrack_temp&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls<span class="w"> </span>-lh<span class="w"> </span>/lustre/groups/ml01/workspace/kemal.inecik/idtrack_temp
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
total 15G
-rw-rwxr--+ 1 kemal.inecik OG-ICB-User 622M Oct 17 17:18 graph_homo_sapiens_ens107_min79_narrow.pickle
-rw-rwxr--+ 1 kemal.inecik OG-ICB-User 7.2G Oct 17 15:01 homo_sapiens_assembly-37.h5
-rw-rwxr--+ 1 kemal.inecik OG-ICB-User 7.0G Oct 31 09:44 homo_sapiens_assembly-38.h5
-rw-rwxr--+ 1 kemal.inecik OG-ICB-User  45K Aug 12 15:57 homo_sapiens_externals_modified.yml
-rw-rwxr--+ 1 kemal.inecik OG-ICB-User 2.2M Nov 10 10:48 results_for_hlca_core_only_ensembl_gene_20221110-094821.pk
-rw-rwxr--+ 1 kemal.inecik OG-ICB-User 2.4M Nov 10 10:43 results_for_hlca_core_only_HGNC Symbol_20221110-094335.pk
-rw-rwxr--+ 1 kemal.inecik OG-ICB-User  57M Nov  1 20:13 results_for_hlca_datasets_ensembl_gene_20221101-191345.pk
-rw-r--r--. 1 kemal.inecik OG-ICB-User  57M Jan 30 03:31 results_for_hlca_datasets_ensembl_gene_20230130-023149.pk
-rw-rwxr--+ 1 kemal.inecik OG-ICB-User  55M Nov  1 18:50 results_for_hlca_datasets_HGNC Symbol_20221101-175029.pk
-rw-r--r--. 1 kemal.inecik OG-ICB-User  55M Jan 30 01:47 results_for_hlca_datasets_HGNC Symbol_20230130-004722.pk
-rw-r--r--. 1 kemal.inecik OG-ICB-User 3.1K Jan 30 00:37 results_for_random_external_conversions_1_20230129-233747.pk
-rw-r--r--. 1 kemal.inecik OG-ICB-User 3.1K Jan 30 04:12 results_for_random_external_conversions_2_20230130-031239.pk
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_dir</span> <span class="o">+</span> <span class="s2">&quot;/results_for_hlca_datasets_ensembl_gene_20230130-023149.pk&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pickle_file_1</span><span class="p">:</span>
    <span class="n">res_ens</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pickle_file_1</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_dir</span> <span class="o">+</span> <span class="s2">&quot;/results_for_hlca_datasets_HGNC Symbol_20230130-004722.pk&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pickle_file_2</span><span class="p">:</span>
    <span class="n">res_hgn</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pickle_file_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_ens</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;Kaminski_2020&#39;, &#39;Meyer_2021&#39;, &#39;MeyerNikolic_unpubl&#39;, &#39;Barbry_unpubl&#39;, &#39;Regev_2021&#39;, &#39;Thienpont_2018&#39;, &#39;Budinger_2020&#39;, &#39;Banovich_Kropski_2020&#39;, &#39;Sheppard_2020&#39;, &#39;Wunderink_2021&#39;, &#39;Lambrechts_2021&#39;, &#39;Zhang_2021&#39;, &#39;Duong_lungMAP_unpubl&#39;, &#39;Janssen_2020&#39;, &#39;Sun_2020&#39;, &#39;Gomperts_2021&#39;, &#39;Eils_2020&#39;, &#39;Schiller_2020&#39;, &#39;Misharin_Budinger_2018&#39;, &#39;Shalek_2018&#39;, &#39;Schiller_2021&#39;, &#39;Peer_Massague_2020&#39;, &#39;Lafyatis_2019&#39;, &#39;Tata_unpubl&#39;, &#39;Xu_2020&#39;, &#39;Sims_2019&#39;, &#39;Schultze_unpubl&#39;])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_ens</span><span class="p">[</span><span class="s1">&#39;MeyerNikolic_unpubl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;changed_only_1_to_n&#39;, &#39;changed_only_1_to_1&#39;, &#39;alternative_target_1_to_1&#39;, &#39;alternative_target_1_to_n&#39;, &#39;matching_1_to_0&#39;, &#39;matching_1_to_1&#39;, &#39;matching_1_to_n&#39;, &#39;input_identifiers&#39;])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_ens</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res_ens</span><span class="p">:</span>
    <span class="n">r_ens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">res_ens</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">r_ens</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_ens</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

<span class="n">r_hgn</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res_hgn</span><span class="p">:</span>
    <span class="n">r_hgn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">res_hgn</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">r_hgn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_hgn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[153]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">column_order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;input_identifiers&quot;</span><span class="p">,</span>
 <span class="s2">&quot;matching_1_to_1&quot;</span><span class="p">,</span> <span class="s2">&quot;changed_only_1_to_1&quot;</span><span class="p">,</span> <span class="s2">&quot;alternative_target_1_to_1&quot;</span><span class="p">,</span>
 <span class="s2">&quot;matching_1_to_n&quot;</span><span class="p">,</span> <span class="s2">&quot;changed_only_1_to_n&quot;</span><span class="p">,</span> <span class="s2">&quot;alternative_target_1_to_n&quot;</span><span class="p">,</span>
 <span class="s2">&quot;matching_1_to_0&quot;</span><span class="p">]</span>
<span class="n">raname_columns</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;input_identifiers&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;matching_1_to_1&quot;</span><span class="p">:</span> <span class="s2">&quot;TDM&quot;</span><span class="p">,</span> <span class="s2">&quot;changed_only_1_to_1&quot;</span><span class="p">:</span> <span class="s2">&quot;CI&quot;</span><span class="p">,</span> <span class="s2">&quot;alternative_target_1_to_1&quot;</span><span class="p">:</span> <span class="s2">&quot;ATM&quot;</span><span class="p">,</span>  <span class="c1"># TDM: target database matching, ATM: alternative target matching</span>
 <span class="s2">&quot;matching_1_to_n&quot;</span><span class="p">:</span> <span class="s2">&quot;TDM&quot;</span><span class="p">,</span> <span class="s2">&quot;changed_only_1_to_n&quot;</span><span class="p">:</span> <span class="s2">&quot;CI&quot;</span><span class="p">,</span> <span class="s2">&quot;alternative_target_1_to_n&quot;</span><span class="p">:</span> <span class="s2">&quot;ATM&quot;</span><span class="p">,</span>
 <span class="s2">&quot;matching_1_to_0&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
<span class="n">higher_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Input IDs&quot;</span><span class="p">,</span>
 <span class="s2">&quot;One-to-One&quot;</span><span class="p">,</span> <span class="s2">&quot;One-to-One&quot;</span><span class="p">,</span> <span class="s2">&quot;One-to-One&quot;</span><span class="p">,</span>
 <span class="s2">&quot;One-to-Many&quot;</span><span class="p">,</span> <span class="s2">&quot;One-to-Many&quot;</span><span class="p">,</span> <span class="s2">&quot;One-to-Many&quot;</span><span class="p">,</span>
 <span class="s2">&quot;One-to-None&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[154]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">r_hgn</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">column_order</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">raname_columns</span><span class="p">)</span>
<span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Target HGNC Names&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="n">higher_columns</span><span class="p">,</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">df2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">r_ens</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">column_order</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">raname_columns</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Target Ensembl&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="n">higher_columns</span><span class="p">,</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[155]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">[[</span><span class="s2">&quot;Target Ensembl&quot;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[173]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span>
<span class="p">(</span>                 <span class="s1">&#39;&#39;</span><span class="p">,</span>            <span class="s1">&#39;Input IDs&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;Target HGNC Names&#39;</span><span class="p">,</span>  <span class="s1">&#39;One-to-One&#39;</span><span class="p">,</span>       <span class="s1">&#39;TDM&#39;</span><span class="p">),</span>
<span class="c1">#(&#39;Target HGNC Names&#39;,  &#39;One-to-One&#39;,        &#39;CI&#39;),</span>
<span class="p">(</span><span class="s1">&#39;Target HGNC Names&#39;</span><span class="p">,</span>  <span class="s1">&#39;One-to-One&#39;</span><span class="p">,</span>       <span class="s1">&#39;ATM&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;Target HGNC Names&#39;</span><span class="p">,</span> <span class="s1">&#39;One-to-Many&#39;</span><span class="p">,</span>       <span class="s1">&#39;TDM&#39;</span><span class="p">),</span>
<span class="c1">#(&#39;Target HGNC Names&#39;, &#39;One-to-Many&#39;,        &#39;CI&#39;),</span>
<span class="p">(</span><span class="s1">&#39;Target HGNC Names&#39;</span><span class="p">,</span> <span class="s1">&#39;One-to-Many&#39;</span><span class="p">,</span>       <span class="s1">&#39;ATM&#39;</span><span class="p">),</span>
<span class="p">(</span>   <span class="s1">&#39;Target Ensembl&#39;</span><span class="p">,</span>  <span class="s1">&#39;One-to-One&#39;</span><span class="p">,</span>       <span class="s1">&#39;TDM&#39;</span><span class="p">),</span>
<span class="c1">#(   &#39;Target Ensembl&#39;,  &#39;One-to-One&#39;,        &#39;CI&#39;),</span>
<span class="c1">#(   &#39;Target Ensembl&#39;,  &#39;One-to-One&#39;,       &#39;ATM&#39;),</span>
<span class="p">(</span>   <span class="s1">&#39;Target Ensembl&#39;</span><span class="p">,</span> <span class="s1">&#39;One-to-Many&#39;</span><span class="p">,</span>       <span class="s1">&#39;TDM&#39;</span><span class="p">),</span>
<span class="c1">#(   &#39;Target Ensembl&#39;, &#39;One-to-Many&#39;,        &#39;CI&#39;),</span>
<span class="c1">#(   &#39;Target Ensembl&#39;, &#39;One-to-Many&#39;,       &#39;ATM&#39;),</span>
<span class="p">(</span>                 <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;One-to-None&#39;</span><span class="p">,</span>          <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="p">]]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[173]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="4" halign="left">Target HGNC Names</th>
      <th colspan="2" halign="left">Target Ensembl</th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th>Input IDs</th>
      <th colspan="2" halign="left">One-to-One</th>
      <th colspan="2" halign="left">One-to-Many</th>
      <th>One-to-One</th>
      <th>One-to-Many</th>
      <th>One-to-None</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>TDM</th>
      <th>ATM</th>
      <th>TDM</th>
      <th>ATM</th>
      <th>TDM</th>
      <th>TDM</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Kaminski_2020</th>
      <td>45947</td>
      <td>33446</td>
      <td>12331</td>
      <td>59</td>
      <td>13</td>
      <td>45353</td>
      <td>496</td>
      <td>98</td>
    </tr>
    <tr>
      <th>Meyer_2021</th>
      <td>20922</td>
      <td>20532</td>
      <td>368</td>
      <td>3</td>
      <td>2</td>
      <td>20692</td>
      <td>213</td>
      <td>17</td>
    </tr>
    <tr>
      <th>MeyerNikolic_unpubl</th>
      <td>33582</td>
      <td>25109</td>
      <td>8342</td>
      <td>15</td>
      <td>10</td>
      <td>33186</td>
      <td>290</td>
      <td>106</td>
    </tr>
    <tr>
      <th>Barbry_unpubl</th>
      <td>16859</td>
      <td>15155</td>
      <td>1679</td>
      <td>1</td>
      <td>4</td>
      <td>16738</td>
      <td>101</td>
      <td>20</td>
    </tr>
    <tr>
      <th>Regev_2021</th>
      <td>30983</td>
      <td>23466</td>
      <td>7387</td>
      <td>8</td>
      <td>9</td>
      <td>30648</td>
      <td>222</td>
      <td>113</td>
    </tr>
    <tr>
      <th>Thienpont_2018</th>
      <td>27958</td>
      <td>22394</td>
      <td>5342</td>
      <td>8</td>
      <td>43</td>
      <td>27541</td>
      <td>246</td>
      <td>171</td>
    </tr>
    <tr>
      <th>Budinger_2020</th>
      <td>26316</td>
      <td>21441</td>
      <td>4807</td>
      <td>6</td>
      <td>6</td>
      <td>26066</td>
      <td>194</td>
      <td>56</td>
    </tr>
    <tr>
      <th>Banovich_Kropski_2020</th>
      <td>33694</td>
      <td>25229</td>
      <td>8131</td>
      <td>15</td>
      <td>57</td>
      <td>33096</td>
      <td>336</td>
      <td>262</td>
    </tr>
    <tr>
      <th>Sheppard_2020</th>
      <td>27147</td>
      <td>21915</td>
      <td>5020</td>
      <td>6</td>
      <td>40</td>
      <td>26742</td>
      <td>239</td>
      <td>166</td>
    </tr>
    <tr>
      <th>Wunderink_2021</th>
      <td>21819</td>
      <td>18856</td>
      <td>2907</td>
      <td>2</td>
      <td>1</td>
      <td>21597</td>
      <td>169</td>
      <td>53</td>
    </tr>
    <tr>
      <th>Lambrechts_2021</th>
      <td>33538</td>
      <td>25091</td>
      <td>8342</td>
      <td>15</td>
      <td>10</td>
      <td>33168</td>
      <td>290</td>
      <td>80</td>
    </tr>
    <tr>
      <th>Zhang_2021</th>
      <td>18474</td>
      <td>18364</td>
      <td>99</td>
      <td>1</td>
      <td>0</td>
      <td>18305</td>
      <td>159</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Duong_lungMAP_unpubl</th>
      <td>27678</td>
      <td>21617</td>
      <td>5994</td>
      <td>6</td>
      <td>10</td>
      <td>27447</td>
      <td>180</td>
      <td>51</td>
    </tr>
    <tr>
      <th>Janssen_2020</th>
      <td>33538</td>
      <td>25091</td>
      <td>8342</td>
      <td>15</td>
      <td>10</td>
      <td>33168</td>
      <td>290</td>
      <td>80</td>
    </tr>
    <tr>
      <th>Sun_2020</th>
      <td>26578</td>
      <td>21097</td>
      <td>5417</td>
      <td>6</td>
      <td>8</td>
      <td>26367</td>
      <td>161</td>
      <td>50</td>
    </tr>
    <tr>
      <th>Gomperts_2021</th>
      <td>31229</td>
      <td>24929</td>
      <td>5910</td>
      <td>14</td>
      <td>28</td>
      <td>30607</td>
      <td>274</td>
      <td>348</td>
    </tr>
    <tr>
      <th>Eils_2020</th>
      <td>32738</td>
      <td>24546</td>
      <td>7519</td>
      <td>17</td>
      <td>44</td>
      <td>31842</td>
      <td>284</td>
      <td>612</td>
    </tr>
    <tr>
      <th>Schiller_2020</th>
      <td>32104</td>
      <td>25106</td>
      <td>6431</td>
      <td>8</td>
      <td>26</td>
      <td>31308</td>
      <td>263</td>
      <td>533</td>
    </tr>
    <tr>
      <th>Misharin_Budinger_2018</th>
      <td>27181</td>
      <td>21945</td>
      <td>5009</td>
      <td>7</td>
      <td>43</td>
      <td>26753</td>
      <td>251</td>
      <td>177</td>
    </tr>
    <tr>
      <th>Shalek_2018</th>
      <td>25328</td>
      <td>21154</td>
      <td>3642</td>
      <td>7</td>
      <td>33</td>
      <td>24638</td>
      <td>198</td>
      <td>492</td>
    </tr>
    <tr>
      <th>Schiller_2021</th>
      <td>17533</td>
      <td>17330</td>
      <td>193</td>
      <td>0</td>
      <td>0</td>
      <td>17384</td>
      <td>139</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Peer_Massague_2020</th>
      <td>19222</td>
      <td>17897</td>
      <td>1247</td>
      <td>4</td>
      <td>11</td>
      <td>19004</td>
      <td>155</td>
      <td>63</td>
    </tr>
    <tr>
      <th>Lafyatis_2019</th>
      <td>22164</td>
      <td>21693</td>
      <td>442</td>
      <td>6</td>
      <td>2</td>
      <td>21885</td>
      <td>258</td>
      <td>21</td>
    </tr>
    <tr>
      <th>Tata_unpubl</th>
      <td>31915</td>
      <td>24230</td>
      <td>7632</td>
      <td>11</td>
      <td>6</td>
      <td>31599</td>
      <td>280</td>
      <td>36</td>
    </tr>
    <tr>
      <th>Xu_2020</th>
      <td>32738</td>
      <td>24546</td>
      <td>7519</td>
      <td>17</td>
      <td>44</td>
      <td>31842</td>
      <td>284</td>
      <td>612</td>
    </tr>
    <tr>
      <th>Sims_2019</th>
      <td>60725</td>
      <td>41583</td>
      <td>16431</td>
      <td>985</td>
      <td>265</td>
      <td>57434</td>
      <td>1830</td>
      <td>1461</td>
    </tr>
    <tr>
      <th>Schultze_unpubl</th>
      <td>24532</td>
      <td>20655</td>
      <td>3820</td>
      <td>5</td>
      <td>6</td>
      <td>24290</td>
      <td>196</td>
      <td>46</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[176]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_hgn</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[176]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;Kaminski_2020&#39;, &#39;Meyer_2021&#39;, &#39;MeyerNikolic_unpubl&#39;, &#39;Barbry_unpubl&#39;, &#39;Regev_2021&#39;, &#39;Thienpont_2018&#39;, &#39;Budinger_2020&#39;, &#39;Banovich_Kropski_2020&#39;, &#39;Sheppard_2020&#39;, &#39;Wunderink_2021&#39;, &#39;Lambrechts_2021&#39;, &#39;Zhang_2021&#39;, &#39;Duong_lungMAP_unpubl&#39;, &#39;Janssen_2020&#39;, &#39;Sun_2020&#39;, &#39;Gomperts_2021&#39;, &#39;Eils_2020&#39;, &#39;Schiller_2020&#39;, &#39;Misharin_Budinger_2018&#39;, &#39;Shalek_2018&#39;, &#39;Schiller_2021&#39;, &#39;Peer_Massague_2020&#39;, &#39;Lafyatis_2019&#39;, &#39;Tata_unpubl&#39;, &#39;Xu_2020&#39;, &#39;Sims_2019&#39;, &#39;Schultze_unpubl&#39;])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[180]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_hgn</span><span class="p">[</span><span class="s2">&quot;Kaminski_2020&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[180]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;changed_only_1_to_n&#39;, &#39;changed_only_1_to_1&#39;, &#39;alternative_target_1_to_1&#39;, &#39;alternative_target_1_to_n&#39;, &#39;matching_1_to_0&#39;, &#39;matching_1_to_1&#39;, &#39;matching_1_to_n&#39;, &#39;input_identifiers&#39;])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[234]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_hgn</span><span class="p">[</span><span class="s2">&quot;Kaminski_2020&quot;</span><span class="p">][</span><span class="s1">&#39;changed_only_1_to_n&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[234]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;target_id&#39;, &#39;last_node&#39;, &#39;final_database&#39;, &#39;graph_id&#39;, &#39;query_id&#39;, &#39;no_corresponding&#39;, &#39;no_conversion&#39;, &#39;no_target&#39;])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[235]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_ids</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res_hgn</span><span class="p">:</span>
    <span class="n">query_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">res_hgn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;input_identifiers&quot;</span><span class="p">]:</span>
        <span class="n">query_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="s2">&quot;query_id&quot;</span><span class="p">])</span>

<span class="n">hgnc_ids</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res_hgn</span><span class="p">:</span>
    <span class="n">hgnc_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">res_hgn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;matching_1_to_1&quot;</span><span class="p">]:</span>
        <span class="n">hgnc_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="s2">&quot;target_id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">res_hgn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;alternative_target_1_to_1&quot;</span><span class="p">]:</span>
        <span class="n">hgnc_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="s2">&quot;target_id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">ens_ids</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res_ens</span><span class="p">:</span>
    <span class="n">ens_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">res_ens</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;matching_1_to_1&quot;</span><span class="p">]:</span>
        <span class="n">ens_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="s2">&quot;target_id&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[236]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">query_ids</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">query_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hgnc_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ens_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
45947 45777 45353
20922 20900 20692
33582 33451 33186
16859 16834 16738
30983 30853 30648
27958 27736 27541
26316 26248 26066
33694 33360 33096
27147 26935 26742
21819 21763 21597
33538 33433 33168
18474 18463 18305
27678 27611 27447
33538 33433 33168
26578 26514 26367
31229 30839 30607
32738 32065 31842
32104 31537 31308
27181 26954 26753
25328 24796 24638
17533 17523 17384
19222 19144 19004
22164 22135 21885
31915 31862 31599
32738 32065 31842
60725 58014 57434
24532 24475 24290
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[237]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">query_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
<span class="n">a2</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">hgnc_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
<span class="n">a3</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ens_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">a2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">a3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[237]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(782442, 774720, 768700)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[238]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">b3</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">a1</span><span class="p">),</span><span class="nb">set</span><span class="p">(</span><span class="n">a2</span><span class="p">),</span><span class="nb">set</span><span class="p">(</span><span class="n">a3</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">b1</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">b2</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">b3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[238]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(94538, 56960, 56536)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[272]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b3</span><span class="o">-</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">b3</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ens_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[272]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;Kaminski_2020&#39;, 11756, 44780, 56536),
 (&#39;Meyer_2021&#39;, 36051, 20485, 56536),
 (&#39;MeyerNikolic_unpubl&#39;, 24123, 32413, 56536),
 (&#39;Barbry_unpubl&#39;, 39911, 16625, 56536),
 (&#39;Regev_2021&#39;, 26455, 30081, 56536),
 (&#39;Thienpont_2018&#39;, 29425, 27111, 56536),
 (&#39;Budinger_2020&#39;, 30876, 25660, 56536),
 (&#39;Banovich_Kropski_2020&#39;, 24140, 32396, 56536),
 (&#39;Sheppard_2020&#39;, 30223, 26313, 56536),
 (&#39;Wunderink_2021&#39;, 35219, 21317, 56536),
 (&#39;Lambrechts_2021&#39;, 24123, 32413, 56536),
 (&#39;Zhang_2021&#39;, 38356, 18180, 56536),
 (&#39;Duong_lungMAP_unpubl&#39;, 29509, 27027, 56536),
 (&#39;Janssen_2020&#39;, 24123, 32413, 56536),
 (&#39;Sun_2020&#39;, 30537, 25999, 56536),
 (&#39;Gomperts_2021&#39;, 30995, 25541, 56536),
 (&#39;Eils_2020&#39;, 25661, 30875, 56536),
 (&#39;Schiller_2020&#39;, 28743, 27793, 56536),
 (&#39;Misharin_Budinger_2018&#39;, 30217, 26319, 56536),
 (&#39;Shalek_2018&#39;, 32318, 24218, 56536),
 (&#39;Schiller_2021&#39;, 39277, 17259, 56536),
 (&#39;Peer_Massague_2020&#39;, 37709, 18827, 56536),
 (&#39;Lafyatis_2019&#39;, 34924, 21612, 56536),
 (&#39;Tata_unpubl&#39;, 25403, 31133, 56536),
 (&#39;Xu_2020&#39;, 25661, 30875, 56536),
 (&#39;Sims_2019&#39;, 2190, 54346, 56536),
 (&#39;Schultze_unpubl&#39;, 32530, 24006, 56536)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[270]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b2</span><span class="o">-</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">b2</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">hgnc_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[270]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;Kaminski_2020&#39;, 11793, 45167, 56960),
 (&#39;Meyer_2021&#39;, 36154, 20806, 56960),
 (&#39;MeyerNikolic_unpubl&#39;, 24284, 32676, 56960),
 (&#39;Barbry_unpubl&#39;, 40223, 16737, 56960),
 (&#39;Regev_2021&#39;, 26709, 30251, 56960),
 (&#39;Thienpont_2018&#39;, 29588, 27372, 56960),
 (&#39;Budinger_2020&#39;, 31120, 25840, 56960),
 (&#39;Banovich_Kropski_2020&#39;, 24202, 32758, 56960),
 (&#39;Sheppard_2020&#39;, 30402, 26558, 56960),
 (&#39;Wunderink_2021&#39;, 35477, 21483, 56960),
 (&#39;Lambrechts_2021&#39;, 24284, 32676, 56960),
 (&#39;Zhang_2021&#39;, 38556, 18404, 56960),
 (&#39;Duong_lungMAP_unpubl&#39;, 29794, 27166, 56960),
 (&#39;Janssen_2020&#39;, 24284, 32676, 56960),
 (&#39;Sun_2020&#39;, 30828, 26132, 56960),
 (&#39;Gomperts_2021&#39;, 31114, 25846, 56960),
 (&#39;Eils_2020&#39;, 25741, 31219, 56960),
 (&#39;Schiller_2020&#39;, 28974, 27986, 56960),
 (&#39;Misharin_Budinger_2018&#39;, 30371, 26589, 56960),
 (&#39;Shalek_2018&#39;, 32544, 24416, 56960),
 (&#39;Schiller_2021&#39;, 39511, 17449, 56960),
 (&#39;Peer_Massague_2020&#39;, 37940, 19020, 56960),
 (&#39;Lafyatis_2019&#39;, 34941, 22019, 56960),
 (&#39;Tata_unpubl&#39;, 25483, 31477, 56960),
 (&#39;Xu_2020&#39;, 25741, 31219, 56960),
 (&#39;Sims_2019&#39;, 1934, 55026, 56960),
 (&#39;Schultze_unpubl&#39;, 32772, 24188, 56960)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[271]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b1</span><span class="o">-</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">b1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">query_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[271]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;Kaminski_2020&#39;, 48591, 45947, 94538),
 (&#39;Meyer_2021&#39;, 73616, 20922, 94538),
 (&#39;MeyerNikolic_unpubl&#39;, 60956, 33582, 94538),
 (&#39;Barbry_unpubl&#39;, 77679, 16859, 94538),
 (&#39;Regev_2021&#39;, 63555, 30983, 94538),
 (&#39;Thienpont_2018&#39;, 66580, 27958, 94538),
 (&#39;Budinger_2020&#39;, 68222, 26316, 94538),
 (&#39;Banovich_Kropski_2020&#39;, 60844, 33694, 94538),
 (&#39;Sheppard_2020&#39;, 67391, 27147, 94538),
 (&#39;Wunderink_2021&#39;, 72719, 21819, 94538),
 (&#39;Lambrechts_2021&#39;, 61000, 33538, 94538),
 (&#39;Zhang_2021&#39;, 76064, 18474, 94538),
 (&#39;Duong_lungMAP_unpubl&#39;, 66860, 27678, 94538),
 (&#39;Janssen_2020&#39;, 61000, 33538, 94538),
 (&#39;Sun_2020&#39;, 67960, 26578, 94538),
 (&#39;Gomperts_2021&#39;, 63309, 31229, 94538),
 (&#39;Eils_2020&#39;, 61800, 32738, 94538),
 (&#39;Schiller_2020&#39;, 62434, 32104, 94538),
 (&#39;Misharin_Budinger_2018&#39;, 67357, 27181, 94538),
 (&#39;Shalek_2018&#39;, 69210, 25328, 94538),
 (&#39;Schiller_2021&#39;, 77005, 17533, 94538),
 (&#39;Peer_Massague_2020&#39;, 75316, 19222, 94538),
 (&#39;Lafyatis_2019&#39;, 72374, 22164, 94538),
 (&#39;Tata_unpubl&#39;, 62623, 31915, 94538),
 (&#39;Xu_2020&#39;, 61800, 32738, 94538),
 (&#39;Sims_2019&#39;, 33813, 60725, 94538),
 (&#39;Schultze_unpubl&#39;, 70006, 24532, 94538)]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="initialization_test.html" class="btn btn-neutral float-left" title="Initialization and Tests" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="random_data.html" class="btn btn-neutral float-right" title="Calculations with Random Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Kemal Inecik.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>